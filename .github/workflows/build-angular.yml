name: Build Angular App

on:
  push:
    branches: [ main, TEST* ]

jobs:
  build-angular:
    runs-on: ubuntu-latest

    steps: 
      - uses: actions/checkout@v4

      - name: Setup Node JS
        uses: actions/setup-node@v4
        with:
           node-version: 18.x
         
      - name: Install dependencies
        run: npm install

      - name: Build
        run: npm run build

      - name: Upload Build Artifacts
        uses: actions/upload-artifact@v4
        with:
          name: build-artifact
          path: dist
          
  job2:
    runs-on: ubuntu-latest
    
    steps: 
      - name: Test
        run: echo "test step"
        
  deploy-angular:
    runs-on: ubuntu-latest
    if: ${{ always() }}
    needs: 
       - build-angular
       - job2
    steps: 
      - name: Test
        id: test
        run: echo "name='test step'" >> $GITHUB_OUTPUT  

      - name: Test2
        run: echo ${{ steps.test.outputs.name }}

      - name: Download Artifacts 
        uses: actions/download-artifact@v4
        with:
          name: build-artifact
          path: artifacts

      - name: Display structure of downloaded files
        run: ls -R artifacts
  
